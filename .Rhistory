theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 3, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 5, col="orange",
fill = "black")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Variety", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 3, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 5, col="orange",
fill = "blue")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Variety", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 3, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 5, col="orange",
fill = "green")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Variety", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 3, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 5, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Variety", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 5, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Variety", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Variety", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = blue, fill = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Variety", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = "blue", fill = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Variety", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Variety", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude", size = 10) +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude", size = 20) +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude", size = 5) +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank(),
panel.grid.major = element_blank()) +
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 22, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site, xlim = 3000))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site, ylim = 3000))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site, ylim = 3000))+
geom_point() +
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="orange",
fill = "#1b7837", ylim = 3000)+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
ylim(3000)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
ylim(0,3000)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
ylim(0,2500)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
ylim(0,2400)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="orange",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
ylim(0,2400)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="#a6dba0",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 1, color = site))+
geom_point() +
ylim(0,2400)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="#a6dba0",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 5, color = site))+
geom_point() +
ylim(0,2400)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="#a6dba0",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 10, color = site))+
geom_point() +
ylim(0,2400)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="#a6dba0",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 1, color = site))+
geom_point() +
ylim(0,2400)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="#a6dba0",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
ylim(0,2400)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="#a6dba0",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
##
rm(list=ls())
library(tidyverse)
setwd("~/GitHub/hemp-multistate")
avg_yields <- function(f) {
data <- read.csv(f)
avg_yields <- data %>%
select(site, variety, grain.m, grain.a, straw.m, straw.a)%>%
filter(variety %in% c( "Altair", "Anka", "Bialobrzeskie", "CFX-1" ,"CFX-2", "Grandi",
"H-51", "Henola", "Hlesia", "Hliana", "Lara", "NWG 2730",
"NWG 2463", "NWG 4000", "NWG 4113", "Vega", "X-59"))%>%
mutate(site = toupper(site), variety = toupper(variety)) %>%
group_by(site,variety) %>%
summarize(count = n(),
avg_grain.a = mean(grain.a, na.rm=T),
avg_straw.a = mean(straw.a, na.rm=T),
se_grain.a = sd(grain.a, na.rm=T)/sqrt(n()),
se_straw.a = sd(straw.a, na.rm=T)/sqrt(n()))
return(avg_yields)
}
avg_list <- lapply((list.files(path="./data",pattern="multistate_2021_[0-9]{3}.csv",full.names=TRUE)),avg_yields)
avg_data <- bind_rows(avg_list)
# New working
# Grains
grains <- avg_data %>%
group_by(variety) %>%
filter(!is.na(avg_grain.a)) %>%
arrange(desc(avg_grain.a))
grains$variety <- factor(grains$variety, levels=c(unique(grains$variety)))
grains$site <- factor(grains$site, levels = c("MONTANA","VERMONT","WISCONSIN",
"MICHIGAN","CORNELL","KENTUCKY LEXINGTON","VIRGINIA"))
unique(avg_data$site)
grains.m <- grains %>%
group_by(variety) %>%
summarise( avg_grain.a = mean(avg_grain.a ))
grains.m$variety <- factor(grains.m$variety, levels=c(unique(grains.m$variety)))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 2, color = site))+
geom_point() +
ylim(0,2400)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="#a6dba0",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
ggplot(grains, aes(x = variety, y = avg_grain.a, size = 5, color = site))+
geom_point() +
ylim(0,2400)+
guides( size = "none")+
geom_point(data = grains.m, stat ="identity", shape = 23, size = 6, col="#a6dba0",
fill = "#1b7837")+
scale_color_manual(name = "Latitude",
labels = c( "47°", "45°", "44°", "42.6°", "42.4°", "38°", "37°"),
values = c("#4575b4","#74add1", "#abd9e9", "#fee090",
"#fdae61", "#f46d43", "#d73027"))+
labs(title = "2021 Grain Production", x = "Genotype", y = "Yield ~ lb/A ",
color = "Latitude") +
theme_bw(base_size = 12) +
theme(plot.background = element_blank())+
theme(axis.text.x = element_text(angle=45, hjust = 1, vjust = 1))+
theme(legend.title = element_text(size =12))
